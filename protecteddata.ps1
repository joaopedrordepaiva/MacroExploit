Add-Type -AssemblyName System.Security

Function Encrypt-WithMachineKey($s) {
    $bytes = [System.Text.Encoding]::Unicode.GetBytes($s)
    $SecureStr = [Security.Cryptography.ProtectedData]::Protect($bytes, $null, [Security.Cryptography.DataProtectionScope]::CurrentUser)
    Write-Output($SecureStr.length)
    $SecureStrBase64 = [System.Convert]::ToBase64String($SecureStr)
    return $SecureStrBase64
}

Function Decrypt-WithMachineKey($s) {
    $SecureStr = [System.Convert]::FromBase64String($s)
    $bytes = [Security.Cryptography.ProtectedData]::Unprotect($SecureStr, $null, [Security.Cryptography.DataProtectionScope]::CurrentUser)
    $Password = [System.Text.Encoding]::Unicode.GetString($bytes)
    return $Password
}

Write-Output(Encrypt-WithMachineKey("1820364"))
# Write-Output(Decrypt-WithMachineKey("AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAjrK55vt6HUaoL9TbjZORFwAAAAACAAAAAAAQZgAAAAEAACAAAADF6fsv/nnTUS9EbYSmF8A+CQZL/exWcxkN9IwG6hSSqQAAAAAOgAAAAAIAACAAAADdqCsfuBwK0G/2zpb5WwfMSr0CLe+N7c8CnLbhS/8qahAAAADZ32Kujm6ym1Mt5uKeajhvQAAAAC1ysjN6qOS3Z9D/v3uPf+KGN+H5ps7OB41jwEY/gRsNQPqPgenJim5wmssMkco9v2pFk48GewFedgljMwV6gj0="))

