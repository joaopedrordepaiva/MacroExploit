from Crypto.Cipher import AES
import binascii
import subprocess
import sys
import os
subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'pycryptodome'])
FilePath = 'C:\\Users\\' + os.getlogin()  + '\\AppData\\Local\\Temp\\PowerOut.txt'
File = open(FilePath, 'r', encoding='UTF-16')
Lines = File.readlines()
File.close()
File = open(FilePath, 'w', encoding='UTF-16')
key = binascii.a2b_base64(Lines[0].strip())
for line in Lines[1:]:
    data = binascii.a2b_base64(line.strip())
    nonce, tag = data[:12], data[-16:]
    cipher = AES.new(key, AES.MODE_GCM, nonce)
    File.write(cipher.decrypt_and_verify(data[12:-16], tag).decode('utf-8') + '\n')
File.close()
